<!DOCTYPE html>
<html>
  
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="alternate" type="application/rss+xml" title="Simple IT ü§ò Rocks" href="http://simpleit.rocks/feed.xml">

  <!-- jQuery -->
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>

  <!-- Fontawesome -->
  <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome.min.css" type="text/css" media="screen" />

  <!-- Mermaid -->
  <link rel="stylesheet" href="/bower_components/mermaid/dist/mermaid.forest.css" type="text/css" media="screen" />

  <!-- Bootstrap -->
  <!--link rel="stylesheet" type="text/css" href="/bower_components/bootstrap/dist/css/bootstrap.css"-->
  <link rel="stylesheet" type="text/css" href="/css/bootstrap-flex.css">
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

  <!-- Custom css -->
  <link rel="stylesheet" href="/css/main.css">

  
  <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Handling Mysql Credentials From Linux Command Line The Right Way - Simple IT ü§ò Rocks</title>
<meta property="og:title" content="Handling Mysql Credentials From Linux Command Line The Right Way" />
<meta name="description" content="Guide to use configuration files to handle MySQL user and password information so they are never typed in Linux console." />
<meta property="og:description" content="Guide to use configuration files to handle MySQL user and password information so they are never typed in Linux console." />
<link rel="canonical" href="http://simpleit.rocks/handling-mysql-credentials-from-linux-command-line-the-right-way/" />
<meta property="og:url" content="http://simpleit.rocks/handling-mysql-credentials-from-linux-command-line-the-right-way/" />
<meta property="og:site_name" content="Simple IT ü§ò Rocks" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-11-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@simpleitrocks" />
<meta name="twitter:creator" content="@marcanuy" />
<meta property="fb:app_id" content="1822851531277021" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Handling Mysql Credentials From Linux Command Line The Right Way",
    "datePublished": "2016-11-15T00:00:00+00:00",
    "description": "Guide to use configuration files to handle MySQL user and password information so they are never typed in Linux console.",
    "url": "http://simpleit.rocks/handling-mysql-credentials-from-linux-command-line-the-right-way/"
  }
</script>
<!-- End Jekyll SEO tag -->

  

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1912030305535489",
    enable_page_level_ads: true
  });
</script>



</head>


  <body>

    

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28572639-2', 'auto');
  ga('send', 'pageview');

</script>



    <header class="site-header">

  <!-- mermaid -->
  <script src="/bower_components/mermaid/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <!-- endmermaid -->

  <div class="text-xs-center m-b-2">

    <a class="display-1" href="/" style="text-decoration: none">Simple IT ü§ò Rocks</a>

  </div>

  
  <div class="jumbotron jumbotron-fluid bg-inverse">
  <div class="container">
    
    
    
    
    
    <h1 class="title">Handling Mysql Credentials From Linux Command Line The Right Way </h1>
    
    
    <p class="lead">
      <small class="text-muted subtitle">Hide MySQL user and password from command line</small>
    </p>
    
  </div>
</div>

  

</header>


    <div class="container-fluid">
      <header class="post-header">
  <div class="post-meta">
    
    <i class="fa fa-calendar" aria-hidden="true"></i>
    <time datetime="2016-11-15T00:00:00+00:00" itemprop="datePublished">Nov 15, 2016</time>
    
  </div>
  <div>
    <div class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList" class="list-/inline breadcrumb">

    
    
    
    


<li itemprop="itemListElement" itemscope
    itemtype="http://schema.org/ListItem"
    class="breadcrumb-item">
  
  <a itemscope itemtype="http://schema.org/Thing"
     itemprop="item" href="/">
    
    <i class="fa fa-home" aria-hidden="true"></i>
    

    Home
  </a>
  
  <meta itemprop="position" content="1" />
</li>

    
    

    
    
    
    
    
    
    
    


<li itemprop="itemListElement" itemscope
    itemtype="http://schema.org/ListItem"
    class="breadcrumb-item">
  
  <a itemscope itemtype="http://schema.org/Thing"
     itemprop="item" href="/docs">
    

    docs
  </a>
  
  <meta itemprop="position" content="2" />
</li>

    

    
    
    
    
    
    


<li itemprop="itemListElement" itemscope
    itemtype="http://schema.org/ListItem"
    class="breadcrumb-item">
  
  <a itemscope itemtype="http://schema.org/Thing"
     itemprop="item" href="/docs/sql">
    

    sql
  </a>
  
  <meta itemprop="position" content="3" />
</li>

    

    
    
    
    
    
    


<li itemprop="itemListElement" itemscope
    itemtype="http://schema.org/ListItem"
    class="breadcrumb-item">
  
  <a itemscope itemtype="http://schema.org/Thing"
     itemprop="item" href="/docs/sql/mysql">
    

    mysql
  </a>
  
  <meta itemprop="position" content="4" />
</li>

    

    
    
    
    
    
    


<li itemprop="itemListElement" itemscope
    itemtype="http://schema.org/ListItem"
    class="breadcrumb-item active">
  
  <span itemscope itemtype="http://schema.org/Thing"
       itemprop="item">
    

    <span itemprop="name">Handling Mysql Credentials From Linux Command Line The Right Way</span>
  </span>
  
  <meta itemprop="position" content="5" />
</li>

    

    
    
  </ol>
</div>

  </div>
</header>

<div class="post-content" itemprop="articleBody">
  <div class="row">

  <div class="col-md-3 site-sidebar">
    <div class="si-ad m-1 mx-auto">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_side_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="5882730780"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  
  
</div>

    
    <div class="sticky" style="position:sticky; top:10px">
      <div>
	<h4>Table of Contents</h4>
	<ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#setting-up-the-credentials-file">Setting up the credentials file</a></li>
<li class="toc-entry toc-h2"><a href="#using-the-config-file">Using the config file</a></li>
<li class="toc-entry toc-h2"><a href="#usage-examples">Usage examples</a></li>
<li class="toc-entry toc-h3"><a href="#mysql-backup-script">MySQL Backup script</a></li>
<li class="toc-entry toc-h3"><a href="#truncate-mysql-tables-from-console">Truncate MySQL tables from console</a></li>
<li class="toc-entry toc-h2"><a href="#summary">Summary</a></li>
<li class="toc-entry toc-h2"><a href="#references">References</a></li>
</ul>
      </div>
      <div>
	<div class="site-share">
  
  <ul class="share-buttons list-inline m-b-1 text-xs-center">
    <li class="list-inline-item">
      <div>
  <a class="twitter-share-button"
     href="https://twitter.com/share"
     data-url="http://simpleit.rocks/handling-mysql-credentials-from-linux-command-line-the-right-way/"
     data-via=""
     data-text="Guide to use configuration files to handle MySQL user and password information so they are never typed in Linux console.
"
     data-related="marcanuy,{"username"=>"simpleitrocks"}"
     data-count="vertical">
    Tweet
  </a>
  <script>
   window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
  </script>
</div>

    </li>
    <li class="list-inline-item">
      <div>
  <!-- Place this tag in your head or just before your close body tag. -->
  <script src="https://apis.google.com/js/platform.js" async defer></script>

  <!-- Place this tag where you want the +1 button to render. -->
  <div class="g-plusone" data-size="tall"></div>
</div>

    </li>
    <li class="list-inline-item">
      <div>
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) return;
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/it_IT/sdk.js#xfbml=1&version=v2.0";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));</script>

  <div class="fb-like" data-href="http://simpleit.rocks/handling-mysql-credentials-from-linux-command-line-the-right-way/" data-layout="box_count" data-action="like" data-show-faces="false" data-share="true"></div>
</div>

    </li>
  </ul>
  
</div>

      </div>
    </div>
    
  </div> <!-- end col -->

  <div class="col-md-8 site-content">

    
	<p class="lead">
	  Guide to use configuration files to handle MySQL user and password information so they are never typed in Linux console.

	</p>
    

    <div class="si-ad m-1 mx-auto">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_before_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="2929264389"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  
</div>


    <h2 id="overview">Overview</h2>

<p>Credentials should never by typed in the command line, it is better to
handle them in configuration files so they are never shown in logs,
processes and you don‚Äôt need to explicitly type them.</p>

<p>This is specially useful to automate <abbr title="My Structured Query Language">MySQL</abbr> backups and use it safely
in shared environments like a <abbr title="Virtual Private Server">VPS</abbr> or any shared hosting.</p>

<p>We use <abbr title="My Structured Query Language">MySQL</abbr> configuration files to configure credentials as they are
read at the startup stage.</p>

<blockquote class="blockquote" cite="http://dev.mysql.com/doc/refman/5.7/en/option-files.html">
  <p>Option files provide a convenient way to specify commonly used
options so that they need not be entered on the command line each
time you run a program.</p>
  <footer class="blockquote-footer"> <cite><abbr title="My Structured Query Language">MySQL</abbr> 5.7 Reference Manual
in <a href="http://dev.mysql.com/doc/refman/5.7/en/option-files.html">Using Option Files</a></cite></footer>
</blockquote>

<p class="alert alert-danger">Always avoid typing the user and password <code class="highlighter-rouge">$ mysql --host=localhost
--user=myname --password=mypass mydb</code></p>

<h2 id="setting-up-the-credentials-file">Setting up the credentials file</h2>

<p>We create a configuration file <code class="highlighter-rouge">mydb.cnf</code> with the following format.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[client]
host=
user=
password=
</code></pre>
</div>

<h2 id="using-the-config-file">Using the config file</h2>

<p>Then we can use the <code class="highlighter-rouge">defaults-extra-file</code> parameter to tell <abbr title="My Structured Query Language">MySQL</abbr> to read our configuration.</p>

<blockquote class="blockquote" cite="http://dev.mysql.com/doc/refman/5.7/en/option-file-options.html#option_general_defaults-extra-file">
  <p>‚Äìdefaults-extra-file=file_name</p>

  <p>Read this option file after the global option file but (on Unix)
  before the user option file and (on all platforms) before the login
  path file. (For information about the order in which option files are
  used, see Section 5.2.6, ‚ÄúUsing Option Files‚Äù.) If the file does not
  exist or is otherwise inaccessible, an error occurs. file_name is
  interpreted relative to the current directory if given as a relative
  path name rather than a full path name.</p>
  <footer class="blockquote-footer"> <cite><abbr title="My Structured Query Language">MySQL</abbr> 5.7 Reference Manual <a href="http://dev.mysql.com/doc/refman/5.7/en/option-file-options.html#option_general_defaults-extra-file">5.2.7 Command-Line Options that Affect Option-File Handling</a></cite></footer>
</blockquote>

<h2 id="usage-examples">Usage examples</h2>

<p>Having the credentials in a configuration file makes it possible to
create scripts and automate tasks easily.</p>

<h3 id="mysql-backup-script"><abbr title="My Structured Query Language">MySQL</abbr> Backup script</h3>

<p>Having this configuration we can easily make a backup script to build
a <a href="https://en.wikipedia.org/wiki/Cron">cronjob</a> and automatically
backup the database regularly using <kbd>mysqldump</kbd>. Edit the
file <code class="highlighter-rouge">backup.sh</code> with the following content.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Backup database from console</span>
<span class="nv">DATABASE</span><span class="o">=</span>
<span class="nv">DEFAULTS_FILE</span><span class="o">=</span><span class="nv">$DATABASE</span>.cnf
<span class="nv">BACKUP_DIR</span><span class="o">=</span>
<span class="nv">LOGS_DIR</span><span class="o">=</span>

<span class="nv">DB_OUT_FILENAME</span><span class="o">=</span><span class="nv">$DEFAULTS_FILE</span>-<span class="sb">`</span>date +<span class="se">\%</span>Y<span class="se">\%</span>m<span class="se">\%</span>d<span class="sb">`</span>.sql.gz
mysqldump --defaults-extra-file<span class="o">=</span><span class="nv">$DEFAULTS_FILE</span> <span class="nv">$DATABASE</span> 2&gt;&gt; <span class="nv">$LOGS_DIR</span>/<span class="nv">$DATABASE</span>.log | gzip - &gt; <span class="nv">$BACKUP_DIR</span>/<span class="nv">$DB_OUT_FILENAME</span>
</code></pre>
</div>

<p>Then make it executable <kbd>chmod +x backup.sh</kbd></p>

<h3 id="truncate-mysql-tables-from-console">Truncate <abbr title="My Structured Query Language">MySQL</abbr> tables from console</h3>

<blockquote class="blockquote" cite="http://dev.mysql.com/doc/refman/5.7/en/truncate-table.html">
  <p>TRUNCATE TABLE empties a table completely. It requires the DROP privilege.</p>
  <footer class="blockquote-footer"> <cite><abbr title="My Structured Query Language">MySQL</abbr> 5.7 Reference Manual in <a href="http://dev.mysql.com/doc/refman/5.7/en/truncate-table.html">14.1.34 TRUNCATE TABLE Syntax</a></cite></footer>
</blockquote>

<p>We can remove all the content from all the tables of a database
automatically with the following script <code class="highlighter-rouge">truncate_db.sh</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Truncate database tables from console</span>
<span class="nv">DATABASE</span><span class="o">=</span>
<span class="nv">DEFAULTS_FILE</span><span class="o">=</span><span class="nv">$DATABASE</span>.cnf

mysql --defaults-extra-file<span class="o">=</span><span class="s2">"</span><span class="nv">$DEFAULTS_FILE</span><span class="s2">"</span> -Nse <span class="s1">'show tables'</span> <span class="nv">$DATABASE</span> | <span class="k">while </span><span class="nb">read </span>table; <span class="k">do </span>mysql --defaults-extra-file<span class="o">=</span><span class="s2">"</span><span class="nv">$DEFAULTS_FILE</span><span class="s2">"</span> -e <span class="s2">"truncate table </span><span class="nv">$table</span><span class="s2">"</span> <span class="nv">$DATABASE</span>; <span class="k">done</span>
</code></pre>
</div>

<p>Then make it executable <kbd>chmod +x truncate_db.sh</kbd>.</p>

<h2 id="summary">Summary</h2>

<p>Using <abbr title="My Structured Query Language">MySQL</abbr> options file, it is very easy to setup a safer environment
than executing commands with the user or password shown in console.</p>

<p>Backing up the database or perform any other task from console with
the <code class="highlighter-rouge">mysql</code> or <code class="highlighter-rouge">mysqldump</code> command becomes trivial.</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://gist.github.com/marcanuy/5977648">https://gist.github.com/marcanuy/5977648</a></li>
  <li><a href="http://dev.mysql.com/doc/refman/5.7/en/option-files.html">http://dev.mysql.com/doc/refman/5.7/en/option-files.html</a></li>
</ul>



    <div class="post-comments">
  

  <div id="disqus_thread"></div>
  <script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    /*
    var disqus_config = function () {
    this.page.url = '/handling-mysql-credentials-from-linux-command-line-the-right-way/';  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = 'simpleitrocks'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    
    s.src = '//simpleitrocks.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  
  
  
</div>


    <div class="row">
      <div class="col-md-6">
	






<div class="post-same-category">
  <h4>Articles in this category</h4>
  <div class="list-group">

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <a class="list-group-item list-group-item-action " href="/how-to-dump-and-import-utf-8-mysql-databases-in-a-safe-way/">
      How To Dump And Import Utf 8 Mysql Databases In A Safe Way
    </a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <a class="list-group-item list-group-item-action active" href="/handling-mysql-credentials-from-linux-command-line-the-right-way/">
      Handling Mysql Credentials From Linux Command Line The Right Way
    </a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
</div>


	




      </div>
      <div class="col-md-5">
	
	
	<div class="si-ad m-1 mx-auto">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_after_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="5104001581"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  
</div>

	
      </div>
    </div>
  </div> <!-- end col -->
</div>


</div>

    </div>

    <footer class="site-footer p-y-3">

  <div class="container">

    <h2 class="footer-heading text-muted">Simple IT ü§ò Rocks</h2>

    <div class="row">
      <div class="col-xs-6">
        <ul class="footer-nav">
          <li>
	      <i class="fa fa-keyboard-o" aria-hidden="true"></i>Coded by <a href="http://marcanuy.com" rel="author">Marcelo Canina</a>
	  </li>
	  
          <li>
            <i class="fa fa-twitter" aria-hidden="true"></i><a href="https://twitter.com/simpleitrocks"><span class="username">simpleitrocks</span></a>

          </li>
          
	  <li>
	    <i class="fa fa-user" aria-hidden="true"></i><a href="/about">About</a>
	  </li>
	  <li>
	    <i class="fa fa-search" aria-hidden="true"></i><a href="/search">Search</a>
	  </li>
        </ul>
      </div>

      <div class="col-xs-6">
	<div class="text-xs-right text-muted">
          <p>Clutter-free software concepts. Written on the go.
</p>
	</div>
      </div>
    </div>

  </div>
</footer>

<div class="si-license bg-inverse">
  <div class="text-muted text-sm-center">
    <small>
      Except as otherwise noted, the content of this page is licensed under
      <a rel="license" class="text-info" href="https://creativecommons.org/licenses/by-nc/4.0/">
	<i class="fa fa-creative-commons" aria-hidden="true"></i> BY-NC 4.0
      </a>
    </small>
  </div>
</div>



  </body>

</html>
